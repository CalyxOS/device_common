{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "c965ea50_41022b73",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1000062
      },
      "writtenOn": "2024-02-26T18:01:51Z",
      "side": 1,
      "message": "The commands work when independently tested, but I haven\u0027t tested a flash script generated by this.",
      "revId": "8221989a12b29751716fabf0f362d0400b473381",
      "serverId": "35266860-6252-469c-a67d-185064479fc0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a0d37a1a_82784b2e",
        "filename": "generate-factory-images-common.sh",
        "patchSetId": 2
      },
      "lineNbr": 248,
      "author": {
        "id": 1000062
      },
      "writtenOn": "2024-02-26T19:04:22Z",
      "side": 1,
      "message": "The other slot is flashed first, since we know that the bootloader is fine in the current slot, or else we wouldn\u0027t be here. We then reboot to the other slot so that we know it flashed okay, and we then proceed to flash the original slot (which is now the \"other\") and reboot again to make sure that works, too.\n\nIf we were to flash both slots without checking, then if something went wrong with flashing or there were something wrong with the image somehow, neither slot would work.\n\nHowever, based on how this is written, if booting into the other slot fails, we should end up back in the original slot, and the following commands would just try to flash that other slot one more time. This would mean the original slot never gets flashed. It doesn\u0027t look like such a situation is handled.\n\nIdeally, if it failed to boot into the other slot, the script should exit with an error. Flashing is a sensitive enough process that we should do more checking.",
      "revId": "8221989a12b29751716fabf0f362d0400b473381",
      "serverId": "35266860-6252-469c-a67d-185064479fc0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "961d01f0_f21cb5af",
        "filename": "generate-factory-images-common.sh",
        "patchSetId": 2
      },
      "lineNbr": 248,
      "author": {
        "id": 1000062
      },
      "writtenOn": "2024-02-26T20:05:07Z",
      "side": 1,
      "message": "Done... We can\u0027t easily tell if it truly booted into the other slot, especially cross-platform since Windows batch files make it very difficult to assign values to variables (and particular from the fastboot executable), but exiting on a fastboot error is better than nothing",
      "parentUuid": "a0d37a1a_82784b2e",
      "revId": "8221989a12b29751716fabf0f362d0400b473381",
      "serverId": "35266860-6252-469c-a67d-185064479fc0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "771db314_2c0f94bf",
        "filename": "generate-factory-images-common.sh",
        "patchSetId": 2
      },
      "lineNbr": 248,
      "author": {
        "id": 1000000
      },
      "writtenOn": "2024-03-04T17:29:38Z",
      "side": 1,
      "message": "https://gitlab.com/CalyxOS/calyxos/-/issues/2157 in the future - can revert this part when we get around to doing that.\n\nI think it should be fine, we may want to handle it a bit better in flasher too though.\n\nNot a blocker and should\u0027ve done it a long time ago, but better late than never.",
      "parentUuid": "961d01f0_f21cb5af",
      "revId": "8221989a12b29751716fabf0f362d0400b473381",
      "serverId": "35266860-6252-469c-a67d-185064479fc0"
    }
  ]
}